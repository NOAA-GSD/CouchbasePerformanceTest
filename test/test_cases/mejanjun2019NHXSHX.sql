select ld.fcst_lead as fcst_lead, count(distinct unix_timestamp(ld.fcst_valid_beg)) as N_times, min(unix_timestamp(ld.fcst_valid_beg)) as min_secs, max(unix_timestamp(ld.fcst_valid_beg)) as max_secs, sum(ld.total) as N0, avg(ld.fabar) as fbar, avg(ld.oabar) as obar, group_concat(distinct ld.fabar, ';', ld.oabar, ';', ld.ffabar, ';', ld.ooabar, ';', ld.foabar, ';', ld.total, ';', unix_timestamp(ld.fcst_valid_beg), ';', h.fcst_lev order by unix_timestamp(ld.fcst_valid_beg), h.fcst_lev) as sub_data from mv_gfs_grid2grid_vsdb.stat_header h, mv_gfs_grid2grid_vsdb.line_data_sal1l2 ld where 1=1 and unix_timestamp(ld.fcst_valid_beg) >= '1546300800' and unix_timestamp(ld.fcst_valid_beg) <= '1561939140' and h.model = 'GFS' and h.vx_mask IN('G2/NHX') and h.fcst_var = 'HGT' and h.fcst_lev IN('P500','P500=') and h.stat_header_id = ld.stat_header_id group by fcst_lead order by fcst_lead;

select ld.fcst_lead as fcst_lead, count(distinct unix_timestamp(ld.fcst_valid_beg)) as N_times, min(unix_timestamp(ld.fcst_valid_beg)) as min_secs, max(unix_timestamp(ld.fcst_valid_beg)) as max_secs, sum(ld.total) as N0, avg(ld.fabar) as fbar, avg(ld.oabar) as obar, group_concat(distinct ld.fabar, ';', ld.oabar, ';', ld.ffabar, ';', ld.ooabar, ';', ld.foabar, ';', ld.total, ';', unix_timestamp(ld.fcst_valid_beg), ';', h.fcst_lev order by unix_timestamp(ld.fcst_valid_beg), h.fcst_lev) as sub_data from mv_gfs_grid2grid_vsdb.stat_header h, mv_gfs_grid2grid_vsdb.line_data_sal1l2 ld where 1=1 and unix_timestamp(ld.fcst_valid_beg) >= '1546300800' and unix_timestamp(ld.fcst_valid_beg) <= '1561939140' and h.model = 'GFS' and h.vx_mask IN('G2/SHX') and h.fcst_var = 'HGT' and h.fcst_lev IN('P500','P500=') and h.stat_header_id = ld.stat_header_id group by fcst_lead order by fcst_lead;
